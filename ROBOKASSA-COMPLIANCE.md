# ‚úÖ –ü—Ä–∏–≤–µ–¥–µ–Ω–∏–µ –∫–æ–¥–∞ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π Robokassa

## –ò–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ–≥–ª–∞—Å–Ω–æ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

–°—Å—ã–ª–∫–∞: https://docs.robokassa.ru/script-parameters/

---

## üîß –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### 1. ‚ùå –£–±—Ä–∞–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä `OutSumCurrency`

**–ë—ã–ª–æ:**
```php
'OutSumCurrency' => 'RUB',
```

**–°—Ç–∞–ª–æ:**
```php
// –ü–∞—Ä–∞–º–µ—Ç—Ä OutSumCurrency —É–±—Ä–∞–Ω - –Ω–µ —É–ø–æ–º–∏–Ω–∞–µ—Ç—Å—è –≤ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
```

**–ü—Ä–∏—á–∏–Ω–∞:**
–ü–∞—Ä–∞–º–µ—Ç—Ä `OutSumCurrency` –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Robokassa –ø–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º —Å–∫—Ä–∏–ø—Ç–∞. –°—É–º–º–∞ –≤—Å–µ–≥–¥–∞ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ —Ä—É–±–ª—è—Ö —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä `OutSum`.

---

### 2. ‚ùå –£–±—Ä–∞–Ω—ã –ø–∞—Ä–∞–º–µ—Ç—Ä—ã `SuccessURL` –∏ `FailURL`

**–ë—ã–ª–æ:**
```php
'SuccessURL' => $cfg['robokassa']['success_url'] ?? null,
'FailURL' => $cfg['robokassa']['fail_url'] ?? null,
```

**–°—Ç–∞–ª–æ:**
```php
// SuccessURL –∏ FailURL –±–µ—Ä—É—Ç—Å—è –∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –õ–ö Robokassa, –Ω–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ –∑–∞–ø—Ä–æ—Å–µ
```

**–ü—Ä–∏—á–∏–Ω–∞:**
–°–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏: *"SuccessURL/FailURL settings in your control panel govern redirect behavior‚Äîno need to pass them in the request."*

URL-—ã –¥–ª—è —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è **–æ–¥–∏–Ω —Ä–∞–∑** –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ Robokassa –≤ —Ä–∞–∑–¥–µ–ª–µ "–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏" –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∫–æ –≤—Å–µ–º –ø–ª–∞—Ç–µ–∂–∞–º.

---

### 3. ‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω —Ñ–æ—Ä–º–∞—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ `OutSum`

**–§–æ—Ä–º–∞—Ç (—É–∂–µ –±—ã–ª –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π):**
```php
$outSum = rk_format_outsum($finalAmount);

// –§—É–Ω–∫—Ü–∏—è rk_format_outsum –≤ helpers.php:
function rk_format_outsum($amount): string
{
  return number_format((float) $amount, 2, '.', '');
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** `5490.00`

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:**
- ‚úÖ –ß–∏—Å–ª–æ —Å –ø–ª–∞–≤–∞—é—â–µ–π —Ç–æ—á–∫–æ–π
- ‚úÖ –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å - —Ç–æ—á–∫–∞ (–Ω–µ –∑–∞–ø—è—Ç–∞—è)
- ‚úÖ 2 –∑–Ω–∞–∫–∞ –ø–æ—Å–ª–µ —Ç–æ—á–∫–∏
- ‚úÖ –ë–µ–∑ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è —Ç—ã—Å—è—á
- ‚úÖ –í —Ä—É–±–ª—è—Ö

**–ü—Ä–∏–º–µ—Ä—ã –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π:**
- `100.00`
- `5490.00`
- `12345.67`

---

### 4. ‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω—ã –ø–∞—Ä–∞–º–µ—Ç—Ä—ã `Shp_`

**–¢–µ–∫—É—â–∏–µ Shp_ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
```php
$shp = [
  'Shp_email' => $email,
  'Shp_product' => $product_code
];
if ($promo) {
  $shp['Shp_promo'] = $promo['code'];
}
```

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:**
- ‚úÖ –ù–∞—á–∏–Ω–∞—é—Ç—Å—è —Å `Shp_`, `SHP_` –∏–ª–∏ `shp_`
- ‚úÖ **–°–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –ø–æ –∞–ª—Ñ–∞–≤–∏—Ç—É** (—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —á–µ—Ä–µ–∑ `ksort($shp)` –≤ helpers.php:24)
- ‚úÖ –£—á–∞—Å—Ç–≤—É—é—Ç –≤ —Ä–∞—Å—á–µ—Ç–µ –ø–æ–¥–ø–∏—Å–∏
- ‚úÖ –ü–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ —Ñ–æ—Ä–º—É –æ–ø–ª–∞—Ç—ã

**–ü–æ—Ä—è–¥–æ–∫ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏:**
1. `Shp_email`
2. `Shp_product`
3. `Shp_promo` (–µ—Å–ª–∏ –µ—Å—Ç—å)

---

### 5. ‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ —Ñ–æ—Ä–º—É–ª–∞ —Ä–∞—Å—á–µ—Ç–∞ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–π —Å—É–º–º—ã (SignatureValue)

**–§–æ—Ä–º—É–ª–∞ —Å–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:**
```
MD5(MerchantLogin:OutSum:InvId:Shp_param1=value1:Shp_param2=value2:Password#1)
```

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤ helpers.php:13-29:**
```php
function rk_make_signature_start(
  string $login,
  string $outSum,
  int $invId,
  string $pass1,
  array $shp = [],
  string $alg = 'md5'
): string {
  // –§–æ—Ä–º—É–ª–∞: MD5(MerchantLogin:OutSum:InvId[:Shp_xxx=yyy:...]:Password1)
  // Receipt –ù–ï —É—á–∞—Å—Ç–≤—É–µ—Ç –≤ –ø–æ–¥–ø–∏—Å–∏ —Å–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Robokassa
  $parts = [$login, $outSum, (string) $invId];
  ksort($shp);  // ‚úÖ –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –∞–ª—Ñ–∞–≤–∏—Ç—É
  foreach ($shp as $k => $v)
    $parts[] = "$k=$v";
  $parts[] = $pass1;
  return rk_hash_string(implode(':', $parts), $alg);
}
```

**–ü—Ä–∏–º–µ—Ä —Ä–∞—Å—á–µ—Ç–∞ –¥–ª—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–ª–∞—Ç–µ–∂–∞:**
```
MerchantLogin: toosmart
OutSum: 5490.00
InvId: 123456
Shp_email: user@example.com
Shp_product: premium_course
Password#1: n67AucI3p5bpUGJOxN3v (—Ç–µ—Å—Ç–æ–≤—ã–π)

–°—Ç—Ä–æ–∫–∞ –¥–ª—è —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è:
toosmart:5490.00:123456:Shp_email=user@example.com:Shp_product=premium_course:n67AucI3p5bpUGJOxN3v

SignatureValue = MD5(—Å—Ç—Ä–æ–∫–∞)
```

**–í–∞–∂–Ω–æ:**
- ‚úÖ Shp_ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –ø–æ –∞–ª—Ñ–∞–≤–∏—Ç—É
- ‚úÖ Receipt **–ù–ï** —É—á–∞—Å—Ç–≤—É–µ—Ç –≤ –ø–æ–¥–ø–∏—Å–∏
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–µ—Å—Ç–æ–≤—ã–π –ø–∞—Ä–æ–ª—å (test_password1) –≤ —Ç–µ—Å—Ç–æ–≤–æ–º —Ä–µ–∂–∏–º–µ

---

## üìã –§–∏–Ω–∞–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|----------|
| `MerchantLogin` | toosmart | –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –º–∞–≥–∞–∑–∏–Ω–∞ |
| `OutSum` | 5490.00 | –°—É–º–º–∞ –≤ —Ä—É–±–ª—è—Ö (—Ñ–æ—Ä–º–∞—Ç: —á–∏—Å–ª–æ.–∫–æ–ø–µ–π–∫–∏) |
| `InvId` | 123456 | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –Ω–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞ |
| `Description` | –ö—É—Ä—Å "–¢–µ–æ—Ä–∏—è..." | –û–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞/—É—Å–ª—É–≥–∏ (–¥–æ 100 —Å–∏–º–≤–æ–ª–æ–≤) |
| `SignatureValue` | abc123... | –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞—è —Å—É–º–º–∞ (MD5) |

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|----------|
| `Email` | user@example.com | Email –ø–æ–∫—É–ø–∞—Ç–µ–ª—è (–¥–ª—è —á–µ–∫–∞ –∏ –∞–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è) |
| `Receipt` | {...} | –ß–µ–∫ –¥–ª—è —Ñ–∏—Å–∫–∞–ª–∏–∑–∞—Ü–∏–∏ (–†–æ–±–æ—á–µ–∫–∏) |
| `Culture` | ru | –Ø–∑—ã–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ (ru/en) |
| `Encoding` | utf-8 | –ö–æ–¥–∏—Ä–æ–≤–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã |

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|----------|
| `Shp_email` | user@example.com | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä (–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ ResultURL) |
| `Shp_product` | premium_course | –ö–æ–¥ –ø—Ä–æ–¥—É–∫—Ç–∞ |
| `Shp_promo` | PROMO2024 | –ü—Ä–æ–º–æ–∫–æ–¥ (–µ—Å–ª–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω) |
| `IsTest` | 1 | –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ is_test: true) |

### ‚ùå –ü–∞—Ä–∞–º–µ—Ç—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ –ù–ï –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è:

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ü–æ—á–µ–º—É –Ω–µ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è |
|----------|---------------------|
| `OutSumCurrency` | –ù–µ —É–∫–∞–∑–∞–Ω –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏, —Å—É–º–º–∞ –≤—Å–µ–≥–¥–∞ –≤ —Ä—É–±–ª—è—Ö |
| `SuccessURL` | –ë–µ—Ä–µ—Ç—Å—è –∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –õ–ö Robokassa |
| `FailURL` | –ë–µ—Ä–µ—Ç—Å—è –∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –õ–ö Robokassa |

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ü–æ—Ä—è–¥–æ–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤ –ø–æ–¥–ø–∏—Å–∏:

1. `MerchantLogin`
2. `OutSum`
3. `InvId`
4. **Shp_ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ –∞–ª—Ñ–∞–≤–∏—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ** (–∫–ª—é—á=–∑–Ω–∞—á–µ–Ω–∏–µ)
5. `Password#1` (–∏–ª–∏ `test_password1` –≤ —Ç–µ—Å—Ç–æ–≤–æ–º —Ä–µ–∂–∏–º–µ)

### –ß—Ç–æ –ù–ï —É—á–∞—Å—Ç–≤—É–µ—Ç –≤ –ø–æ–¥–ø–∏—Å–∏:

- ‚ùå `Receipt` (—á–µ–∫ –¥–ª—è —Ñ–∏—Å–∫–∞–ª–∏–∑–∞—Ü–∏–∏)
- ‚ùå `Email`
- ‚ùå `Description`
- ‚ùå `Culture`
- ‚ùå `Encoding`
- ‚ùå `IsTest`

---

## üìñ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

### ‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —Å–æ–≥–ª–∞—Å–Ω–æ:

1. **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–∫—Ä–∏–ø—Ç–∞**
   - https://docs.robokassa.ru/script-parameters/

2. **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (Shp_)**
   - https://docs.robokassa.ru/script-parameters/#extra

3. **–§–∏—Å–∫–∞–ª–∏–∑–∞—Ü–∏—è (Receipt)**
   - https://docs.robokassa.ru/fiscalization/

### ‚úÖ –í—Å–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ã:

- ‚úÖ OutSum –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ (—á–∏—Å–ª–æ —Å —Ç–æ—á–∫–æ–π, 2 –∑–Ω–∞–∫–∞)
- ‚úÖ Shp_ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –ø–æ –∞–ª—Ñ–∞–≤–∏—Ç—É
- ‚úÖ SignatureValue —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ Receipt –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –¥–ª—è –†–æ–±–æ—á–µ–∫–æ–≤
- ‚úÖ –£–±—Ä–∞–Ω—ã –ª–∏—à–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (OutSumCurrency, SuccessURL, FailURL)
- ‚úÖ SuccessURL –∏ FailURL –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –≤ –õ–ö Robokassa
- ‚úÖ –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç–∞–µ—Ç (IsTest=1)

---

## üß™ –ü—Ä–∏–º–µ—Ä –∏—Ç–æ–≥–æ–≤–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞

```php
[
  'MerchantLogin' => 'toosmart',
  'OutSum' => '5490.00',
  'InvId' => 123456,
  'Description' => '–ö—É—Ä—Å "Clean - –¢–µ–æ—Ä–∏—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —É–±–æ—Ä–∫–∏"',
  'SignatureValue' => 'abc123def456...',
  'Email' => 'user@example.com',
  'Receipt' => '%7B%22sno%22%3A%22usn_income%22%2C...',
  'Shp_email' => 'user@example.com',
  'Shp_product' => 'premium_course',
  'Culture' => 'ru',
  'Encoding' => 'utf-8',
  'IsTest' => 1,  // —Ç–æ–ª—å–∫–æ –≤ —Ç–µ—Å—Ç–æ–≤–æ–º —Ä–µ–∂–∏–º–µ
]
```

---

## üìû –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ –õ–ö Robokassa

**–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –º–∞–≥–∞–∑–∏–Ω–∞:**
- Result URL: https://toosmart.ru/premium/robokassa-callback.php
- Success URL: https://toosmart.ru/premium/success.php
- Fail URL: https://toosmart.ru/premium/fail.php

–≠—Ç–∏ URL –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏ **–Ω–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è** –≤ –∑–∞–ø—Ä–æ—Å–µ.

---

**–î–∞—Ç–∞:** 2025-12-15
**–í–µ—Ä—Å–∏—è:** 4.0 - –ü–æ–ª–Ω–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Robokassa
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ
