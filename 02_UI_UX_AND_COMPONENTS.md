# UI/UX и фронтенд-компоненты

## Шаблоны и базовая разметка
- `src/template.html` — базовый шаблон free-версии: фиксированный header с логотипом, боковой rail-меню, overlay фон и основной `main` c `section.panel`, куда билдер вставляет HTML контента. Кнопка `.menu-handle` управляет раскрытием меню, а `data-lazy` атрибуты помечают виджеты для ленивой инициализации.
- `src/template-paywall.html` — шаблон для premium/закрытых страниц. Структура аналогична, но включает CTA и области для навигации «Далее» в соответствии с цепочкой курса.

## Стили
- `src/styles.css` — общий стиль для free/premium: сетка с меню-rail, состояния `.menu-open`, оформление карточек и блоков контента. CSS рассчитывает адаптивное поведение по брейкпоинтам 768px/900px/1280px.

## JS-модули
- `src/script.js` — основной скрипт, который исполняется на собранных страницах. Он вычисляет `data-mode` (mobile/tablet/desktop/desktop-wide) и `data-input` (touch/pointer), управляет классом `menu-open`, контролирует flyout-навигацию по секциям и навигационные ссылки «Далее». Внутри определён контроллер состояния меню (aria-атрибуты, синхронизация DOM), трекинг активной секции и обработчики свайпов/клавиатуры.
- `src/mode-utils.js` — утилиты для определения режима верстки и входа; экспортируется объект `ModeUtils`, используемый в `script.js` для привязки слушателей resize и input-capabilities.
- `src/js/main.js` + `src/js/modules/menu.js`/`flyout.js` — модульная версия меню: `createMenuStateController` синхронизирует состояние `.menu-open` и aria, `initFlyout` — заглушка для будущего выноса flyout-логики. Используется в dev-сценариях Vite.
- `src/cta.js` и `src/legal-modals.js` — вспомогательные модули для кнопок призыва к действию и открытия модальных окон с юридической информацией (используются сборщиком при внедрении CTA/подвалов).

## Поведение меню и flyout
- Контроллер меню хранит состояние `open`, добавляет/убирает класс `menu-open` на `<body>`, выставляет `aria-expanded` на всех "ручках" (кнопках открытия меню) только если они видимы, и даёт подписку на изменение состояния.
- Flyout в `script.js` отслеживает активный раздел по `data-section` у блоков статьи, обновляет точки-дублеры (`dots-rail`), поддерживает клавиатуру/свайпы и логирует трассировки в debug-режиме (`window.DEBUG_FLYOUT`).

## Навигация по страницам
- Для premium билд подставляет ссылки «Далее» согласно цепочке `intro → course → appendix`. `script.js` читает `data-next-page` в `article` для кнопки CTA «Далее» на free-страницах.
